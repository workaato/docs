 ---
title: 複雑なデータ型
date: 2018-02-13 00:00:00 Z
---

# 複雑なデータ型
ここまで、文字列や整数などのプリミティブなデータ型について説明してきました。ほとんどのAPIでは、より複雑な構造でデータが表現されます。これらは大まかにJSONオブジェクトと配列に分類されます。

## フォーミュラモードでの複雑なデータのマッピング
利点
  - プリミティブな配列を扱うことができます
  - スキーマの事前知識がなくても問題ありません
  - 1つのオブジェクトに多くのフィールドがある場合にも対応できます

## 例
次の例では、Zendeskのチケットに関連するキャンペーンにタグを適用します。これらのキャンペーンはSalesforceで追跡されています。デモンストレーションの目的で、カスタムアクションを使用してこれを実行します。Zendesk APIの[ドキュメント](https://developer.zendesk.com/rest_api/docs/core/tickets#update-ticket)によると、タグは文字列の配列として送信する必要があります。ペイロードは次のようになります：

```json
{
  "ticket": {
    "tags": ["WorkJam", "ProductHour"]
  }
}
```

しかし、この形式はWorkatoの入力フィールドマッピングとは異なります。Workatoでは、キー/値のペアとして主に存在します。この必要な形式は、プリミティブな文字列の配列です。これには複雑なデータ型（文字列の配列）が必要です。

これを行うには、単純に**Tags**入力フィールドをフォーミュラモードに切り替え、必要な構造を形成します。これはいくつかの方法で行うことができます。

まず、静的に定義された文字列の配列でテストを行うことができます。入力値が適切なJSON構文に従っていることを確認してください。フォーミュラモードでの無効な値は、[デザイン時のフォーミュラエラー](/recipes/recipe-design-time-errors.md#design-time-formula-errors)を引き起こします。

![静的な配列の入力](~@img/formula-docs/formula-static-array-input.png)
*フォーミュラモードでの静的な配列の入力*

次に、カスタムアクションが新しいタグでチケットを更新することを確認するために、いくつかのテストを実行することが良いでしょう。この時点で、レシピをさらに改善して、タグを動的に更新することができます。Zendesk APIは文字列の配列を期待しているため、前のアクションから返された<kbd>Campaigns</kbd>の<kbd>Name</kbd>値のみを取得する必要があります。

これは、[`pluck`](/formulas/array-list-formulas.md#pluck)フォーミュラを使用して行います。このフォーミュラは便利にも<kbd>Name</kbd>値の配列を返します。

![動的な配列の入力](~@img/formula-docs/formula-dynamic-array-input.png)
*フォーミュラモードでの動的な配列の入力*

最後に、正しいデータが送信されていることをジョブの詳細を確認することで確認してください。

![フォーミュラモードでのデータ構造の保持](~@img/formula-docs/formula-array-job-details.png)
*フォーミュラモードでのデータ構造の保持*