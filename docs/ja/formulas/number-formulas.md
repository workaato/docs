 # 数式の計算
Rubyでは、Fixnumは整数（例：9、10、11）を指し、Floatは小数（例：1.75）を指します。

Workatoでは、さまざまな数式をサポートしています。Workatoの数式はRubyメソッドのallowlistに含まれており、すべてのRubyメソッドがサポートされているわけではありません。追加の数式をallowlistに追加するためには、いつでも[お問い合わせください](/contact-us.md)。これらの数式の構文と機能は一般的に変更されません。ただし、ほとんどの数式はnull（Rubyでは`nil`と表される）で操作しようとするとエラーが発生し、ジョブが停止します。ただし、`present?`、`presence`、`blank?`は例外です。

Fixnum（整数）の完全なRubyドキュメントは[こちら](http://ruby-doc.org/core-2.3.3/Fixnum.html)、Float（小数）のRubyドキュメントは[こちら](http://ruby-doc.org/core-2.3.3/Float.html)を参照してください。

# 算術演算
算術演算の場合、値が整数型か小数（float）型かは重要です。数式は常に入力された型に従い、返される結果は最も正確な型になります。

例：
- 整数値が提供された場合、整数値が返されます。
- 小数値が提供された場合、小数値が返されます。
- 小数値と整数値の両方が提供された場合、より正確な小数値が返されます。

## 加算（+）演算子

この演算子は、両側のオペランドを加算します。このセクションでは数値の演算について説明します。日付の演算も可能で、[こちら](/formulas/date-formulas.md#date-arithmetic)で確認できます。

### 使用例
| 数式    | 結果 | 型   |
| ----------- | ------ | ------ |
| 4 + 7     | 11     | Fixnum |
| 4.0 + 7   | 11.0   | Float  |
| 4.0 + 7.0 | 11.0   | Float  |

---

## 減算（-）演算子

この演算子は、左側のオペランドから右側のオペランドを減算します。このセクションでは数値の演算について説明します。日付の演算も可能で、[こちら](/formulas/date-formulas.md#date-arithmetic)で確認できます。

### 使用例
| 数式    | 結果 | 型   |
| ----------- | ------ | ------ |
| 4 - 7     | -3     | Fixnum |
| 4.0 - 7   | -3.0   | Float  |
| 4.0 - 7.0 | -3.0   | Float  |

---

## 乗算（\*）演算子
この演算子は、両側のオペランドを乗算します。

### 使用例
| 数式    | 結果 | 型   |
| ----------- | ------ | ------ |
| 4 * 7     | 28     | Fixnum |
| 4.0 * 7   | 28.0   | Float  |
| 4.0 * 7.0 | 28.0   | Float  |

---

## 除算（/）演算子

左側のオペランドを右側のオペランドで除算します。

### 使用例
| 数式    | 結果      | 型   |
| ----------- | ----------- | ------ |
| 4 / 7     | 0           | Fixnum |
| 4.0 / 7   | 0.571428... | Float  |
| 7 / 4     | 1           | Fixnum |
| 7 / 4.0   | 1.75        | Float  |
| 7.0 / 4   | 1.75        | Float  |
| 7.0 / 4.0 | 1.75        | Float  |

---

## 累乗（\*\*）演算子

左側のオペランドを右側のオペランドの累乗とします。

### 使用例
| 数式     | 結果      | 型     |
| ------------ | ----------- | ---------|
| 5**3       | 125         | Fixnum   |
| 4**1.5     | 8.0         | Float    |
| 4.0**2     | 16.0        | Float    |
| 3**-1      | "1/3"       | Rational |
| 8**(3**-1) | 2.0         | Float    |
| 7**-1.6    | 0.044447... | Float    |

---

## 剰余（%）演算子

左側のオペランドを右側のオペランドで除算し、余りを返します。 ### サンプルの使用方法
| 式    | 結果 | タイプ   |
| ----------- | ------ | ------ |
| 4 % 7     | 4      | Fixnum |
| 4.0 % 7   | 4.0    | Float  |
| 4 % 7.0   | 4.0    | Float  |
| 7 % 4     | 3      | Fixnum |
| 7.0 % 4.0 | 3.0    | Float  |

---

# その他の数式

## `abs`

数値の絶対値（正の値）を返します。

### 構文

<kbd>number</kbd>.abs

- <kbd>number</kbd> - 入力の整数または浮動小数点数。

### 使用例

| 式               | 結果 |
| --------------------- | ------ |
| <kbd>45</kbd>.abs     | 45     |
| <kbd>-45</kbd>.abs    | 45     |
| <kbd>45.67</kbd>.abs  | 45.67  |
| <kbd>-45.67</kbd>.abs | 45.67  |

---

## `round`

数値を四捨五入します。この数式は、指定された小数点以下の桁数を持つ値を返します。

### 構文

<kbd>number</kbd>.round(<span style="color:#FF0000">offset</span>)

- <kbd>number</kbd> - 入力の整数または浮動小数点数。
- <span style="color:#FF0000">offset</span> - (オプション) 返す小数点以下の桁数を指定します。負の値を指定することもできます。指定しない場合、この数式は小数点以下の桁数を持たない数値を返します。

### 使用例

| 式                       | 結果  |
| ----------------------------- | ------- |
| <kbd>1234.567</kbd>.round     | 1235    |
| <kbd>1234.567</kbd>.round(2)  | 1234.57 |
| <kbd>1234.567</kbd>.round(-2) | 1230    |

---

# 条件分岐

## `blank?`

この数式は、入力をチェックし、次の場合に `true` を返します。

- 入力が値を持たない数値、NaN（非数）と呼ばれることがあります。これは未定義の値または表現できない値です。例えば、ゼロでの除算の結果や、欠損値です。
- 入力が null の場合。

### 構文

<kbd>Input</kbd>.blank?

- <kbd>Input</kbd> - 入力のデータピル。文字列、数値、日付、または日時のデータ型が使用できます。

### 使用例

| 式                       | 結果  |
| ----------------------------- | ------- |
| <kbd>123</kbd>.blank?         | false   |
| <kbd>0</kbd>.blank?           | false   |
| <kbd>nil</kbd>.blank?         | true    |
| <kbd>""</kbd>.blank?          | true    |

### 動作の詳細

入力が null または空の文字列の場合、数式は true を返します。それ以外のデータに対しては、false を返します。

### 関連情報

- [presence](/formulas/number-formulas.md#presence): データが存在する場合はデータを返し、存在しない場合は nil を返します。
- [present?](/formulas/number-formulas.md#present): 有効な入力がある場合は true を返します。

---

## `even?`

整数の入力をチェックし、偶数の場合に true を返します。

### 構文

<kbd>integer</kbd>.even?

- <kbd>integer</kbd> - 入力の整数。

### 使用例

| 式               | 結果 |
| --------------------- | ------ |
| <kbd>123</kbd>.even?  | false  |
| <kbd>1234</kbd>.even? | true   |

### 関連情報

- [odd?](/formulas/number-formulas.md#odd): 整数の入力をチェックし、奇数の場合に true を返します。

---

## `odd?`

整数の入力をチェックし、奇数の場合に true を返します。

### 構文

<kbd>integer</kbd>.odd?

- <kbd>integer</kbd> - 入力の整数。

### 使用例

| 式              | 結果 |
| -------------------- | ------ |
| <kbd>123</kbd>.odd?  | true   |
| <kbd>1234</kbd>.odd? | false  |

### 関連情報

- [even?](/formulas/number-formulas.md#even): 整数の入力をチェックし、偶数の場合に true を返します。

---

## `present?`

この数式は、入力をチェックし、値が存在する場合に true を返します。入力が nil、論理値 false、空の文字列、または空のリストの場合、false を返します。 ### Syntax

<kbd>Input</kbd>.present?

- <kbd>Input</kbd> - 入力データピル。文字列、数値、日付、またはリストのデータ型が使用できます。

### 使用例

| 式                                                     | 結果    |
| ------------------------------------------------------ | ------- |
| <kbd>"Any Value"</kbd>.present?                        | true    |
| <kbd>123</kbd>.present?                                | true    |
| <kbd>0</kbd>.present?                                  | true    |
| <kbd>"2017-04-02T12:30:00.000000-07:00"</kbd>.present? | true    |
| <kbd>nil</kbd>.present?                                | false   |
| <kbd>""</kbd>.present?                                 | false   |
| <kbd>[]</kbd>.present?                                 | false   |

### 動作原理

入力がnull、空の文字列、または空のリストの場合、式はfalseを返します。それ以外のデータに対してはtrueを返します。

::: tip nil値を含むリストの評価
- 空のリストのみがfalseを返します。

<kbd>[]</kbd>.present? は false を返します。

- nilと空の文字列を含むリストはtrueを返します。

<kbd>[nil,""]</kbd>.present? は true を返します。
:::

### 関連項目

- [presence](/formulas/number-formulas.md#presence): データが存在する場合はデータを返し、存在しない場合はnilを返します。
- [blank?](/formulas/number-formulas.md#blank): データが存在しないか、文字列が空白のみで構成されている場合はnilを返します。

---

## `presence`

データが存在する場合はデータを返し、存在しない場合はnilを返します。

### Syntax

<kbd>Input</kbd>.presence

- <kbd>Input</kbd> - 入力データピル。文字列、数値、日付、または日時のデータ型が使用できます。

### 使用例

| 式                         | 結果        |
| --------------------------- | ----------- |
| <kbd>nil</kbd>.presence         | nil         |
| <kbd>""</kbd>.presence          | nil         |
| <kbd>"Any Value"</kbd>.presence | "Any Value" |
| <kbd>45.0</kbd>.presence        | 45.0        |
| <kbd>0</kbd>.presence           | 0           |

### 動作原理

入力がnullまたは空の文字列の場合、式はnilを返します。それ以外のデータに対しては、元の入力データを返します。

### 関連項目

- [blank?](/formulas/number-formulas.md#blank): データが存在しないか、文字列が空白のみで構成されている場合はnilを返します。
- [present?](/formulas/number-formulas.md#present): 有効な入力がある場合はtrueを返します。

---

# 変換

## `ceil`

入力数値を次の大きな整数または浮動小数点数に丸めます。小数点以下の桁の精度を指定できます。

### Syntax

<kbd>number</kbd>.ceil(<span style="color:#FF0000">precision</span>)

- <kbd>number</kbd> - 入力整数または浮動小数点数です。
- <span style="color:#FF0000">precision</span> - (オプション) 返す小数点以下の桁数を指定できます。負の値を指定することもできます。指定しない場合、この式は小数点以下の桁数を持たない数値を返します。

### 使用例

| 式                      | 結果  |
| ---------------------------- | ------- |
| <kbd>1234.567</kbd>.ceil     | 1235    |
| <kbd>-1234.567</kbd>.ceil    | -1234   |
| <kbd>1234.567</kbd>.ceil(2)  | 1234.57 |
| <kbd>1234.567</kbd>.ceil(-2) | 1300    |

---

## `floor`

入力数値を次の小さい整数または浮動小数点数に丸めます。小数点以下の桁の精度を指定できます。

### Syntax

<kbd>number</kbd>.floor(<span style="color:#FF0000">precision</span>)

- <kbd>number</kbd> - 入力整数または浮動小数点数です。
- <span style="color:#FF0000">precision</span> - (オプション) 返す小数点以下の桁数を指定できます。負の値を指定することもできます。指定しない場合、この式は小数点以下の桁数を持たない数値を返します。 ### サンプル使用法

| フォーミュラ                       | 結果    |
| ----------------------------- | ------- |
| <kbd>1234.567</kbd>.floor     | 1234    |
| <kbd>-1234.567</kbd>.floor    | -1235   |
| <kbd>1234.567</kbd>.floor(2)  | 1234.56 |
| <kbd>1234.567</kbd>.floor(-2) | 1200    |

---

## `to_f`

データを浮動小数点数（数値）のデータ型に変換します。

### 構文

<kbd>Input</kbd>.to_f

- <kbd>Input</kbd> - 数値の入力データです。文字列データ型または整数データ型を使用できます。

### サンプル使用法

| フォーミュラ                   | 結果 |
| ------------------------- | ------ |
| <kbd>45</kbd>.to_f        | 45.0   |
| <kbd>-45</kbd>.to_f       | -45.0  |
| <kbd>"45.67"</kbd>.to_f   | 45.67  |
| <kbd>"Workato"</kbd>.to_f | 0      |

### 動作方法

このフォーミュラは、入力に数値が含まれているかどうかをチェックし、数値が見つからない場合は0を返します。数値に小数点がない場合、数値に `.0` が追加されます。

### 関連項目

- [to_i](/formulas/number-formulas.md#to-i): データを整数（整数）のデータ型に変換します。

---

## `to_i`

データを整数（整数）のデータ型に変換します。

### 構文

<kbd>Input</kbd>.to_i

- <kbd>Input</kbd> - 数値の入力データです。文字列データ型または浮動小数点数データ型を使用できます。

### サンプル使用法

| フォーミュラ                   | 結果 |
| ------------------------- | ------ |
| <kbd>45.43</kbd>.to_i     | 45     |
| <kbd>-45.43</kbd>.to_i    | -45    |
| <kbd>"123"</kbd>.to_i     | 123    |
| <kbd>"Workato"</kbd>.to_i | 0      |

### 動作方法

このフォーミュラは、入力に数値が含まれているかどうかをチェックし、数値が見つからない場合は0を返します。数値に小数点がある場合、小数点以降のすべてが省略されます。

::: tip 整数のチェック
このフォーミュラを使用して、文字列に整数が含まれているかどうかをチェックできます。入力に数値が含まれていない場合、フォーミュラは `0` を返します。
:::

### 関連項目

- [to_f](/formulas/number-formulas.md#to-f): データを浮動小数点数（数値）のデータ型に変換します。

---

## `to_s`

データを文字列（テキスト）のデータ型に変換します。

### 構文

<kbd>Input</kbd>.to_s

- <kbd>Input</kbd> - 任意の入力データです。数値、配列、オブジェクト、または日時データ型を使用できます。

### サンプル使用法

| フォーミュラ                                                    | 結果                             |
| ---------------------------------------------------------- | ---------------------------------- |
| <kbd>-45.67</kbd>.to_s                                     | "-45.67"                           |
| <kbd>"123"</kbd>.to_s                                      | "123"                              |
| <kbd>[1,2,3]</kbd>.to_s                                    | "[1,2,3]"                          |
| <kbd>{key: "Workato"}</kbd>.to_s                           | "{:key=>"Workato"}""               |
| <kbd>"2020-06-05T17:13:27.000000-07:00"</kbd>.to_s         | "2020-06-05T17:13:27.000000-07:00" |
| <kbd>"2020-06-05T17:13:27.000000-07:00"</kbd>.to_s(:short) | "05 Jun 17:13"                     |
| <kbd>"2020-06-05T17:13:27.000000-07:00"</kbd>.to_s(:long)  | "June 05, 2020 17:13"              |

### 動作方法

このフォーミュラは、入力データの文字列表現を返します。

::: tip クイックチップ：出力は文字列データ型です。
リストの文字列表現は、[**繰り返しステップ**](/recipes/steps.md#repeat-step)で使用することはできません。
:::

### 関連項目

- [to_f](/formulas/number -formulas.md#to-f): データを浮動小数点数（数値）のデータ型に変換します。
- [to_i](/formulas/number-formulas.md#to-i): データを整数（整数値）のデータ型に変換します。

---

## `to_currency`

整数/数値を通貨スタイルにフォーマットします。

### 構文

<kbd>Input</kbd>.to_currency

- <kbd>Input</kbd> - 任意の入力文字列。

### 使用例

| フォーミュラ                         | 説明                      | 結果    |
| ------------------------------- | -------------------------------- | --------- |
| <kbd>"345.60"</kbd>.to_currency | デフォルトの通貨記号 "$" を追加します | "$345.60" |

### 応用の使用例

to_currency フォーミュラの応用使用方法について詳しく学びます。これらのカンマ区切りの組み合わせを使用して、所望の通貨形式を実現することができます。例えば:

```ruby
"12345.678".to_currency(delimiter: ".", format: "%n %u", precision: 2, separator: ",", unit: "€")
```

| フォーミュラ           |  説明  |  結果  |
| ------------------| ------------- | -------- |
| <kbd>"345.60"</kbd>.to_currency(unit: "€") | デフォルトの通貨単位を変更します | "€345.60" |
| <kbd>"345.60"</kbd>.to_currency(format: "%n %u") | 数値に対する単位の位置を変更します（数値は `%n` で表され、通貨単位は `%u` で表されます）。間には0または1つのスペースを受け入れます。デフォルトは `"%u%n"` です。 | "345.60 $" |
| <kbd>"-345.60"</kbd>.to_currency(negative_format: "(%u%n)") | 数値が負の場合のフォーマットを指定します（数値は `%n` で表され、通貨単位は `%u` で表されます）。 | "($345.60)" |
| <kbd>"345.678"</kbd>.to_currency               | 精度はデフォルトで小数点以下2桁です | "$345.68"  |
| <kbd>"345.678"</kbd>.to_currency(precision: 3) | 小数点以下の桁数を指定して精度を変更します | "$345.678" |
| <kbd>"345.678"</kbd>.to_currency(separator: ",") | **小数点の区切り記号**を ".", ",", " " のいずれかで指定します。デフォルトは "." です。 |  "$345,68" |
| <kbd>"12345.678"</kbd>.to_currency(delimiter: ".") | **桁区切り記号**を ",", ".", " " のいずれかで指定します。デフォルトは "," です。| ""$12.345.68"|

---

## `to_phone`

文字列または数値をフォーマットされた電話番号（ユーザー定義）に変換します。

### 構文

<kbd>Input</kbd>.to_phone

- <kbd>Input</kbd> - 任意の入力文字列または数値。

### 使用例

| フォーミュラ                                  | 結果               |
| ---------------------------------------- | -------------------- |
| <kbd>"5551234"</kbd>.to_phone                     | 555-1234             |
| <kbd>1235551234</kbd>.to_phone                    | 123-555-1234         |
| <kbd>1235551234</kbd>.to_phone(area_code: true)   | (123) 555-1234       |
| <kbd>1235551234</kbd>.to_phone(delimiter: " ")    | 123 555 1234         |
| <kbd>1235551234</kbd>.to_phone(area_code: true, extension: 555) | (123) 555-1234 x 555 |
| <kbd>1235551234</kbd>.to_phone(country_code: 1)   | +1-123-555-1234      |
| <kbd>"123a456</kbd>.to_phone                     | 123a456              |